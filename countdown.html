<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The RR Summer Countdown</title>
  <style>
    @font-face { font-family: "TheRRs"; src: url("/therrfont.ttf") format("truetype"); }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { width: 100%; height: 100%; }
    body {
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      background: #2a2a2a; color: #dedede; font-family: "TheRRs", sans-serif;
      font-size: 16px; line-height: 1.2; position: relative; overflow: hidden;
    }
    .countdown { display: flex; gap: 1.5rem; text-align: center; }
    .time-segment { display: flex; flex-direction: column; min-width: 4rem; }
    .number {
      display: inline-block; width: 4ch; font-size: 3rem; line-height: 1;
      color: #4193c9; text-align: center; font-variant-numeric: tabular-nums;
    }
    .label {
      margin-top: .25rem; font-size: 1rem; color: #5cc93b;
      text-transform: uppercase; letter-spacing: .05em;
    }
    #recommendedAudio {
      margin-top: 1rem; font-size: 1rem; display: none;
    }
    .finished-message {
      display: none; flex-direction: column; align-items: center; text-align: center;
      gap: 1rem; padding: 0 1rem;
    }
    .finished-title { display: flex; gap: .5rem; font-size: 3rem; }
    .word-happy { color: #5cc93b; }
    .word-summer { color: #4193c9; }
    .word-holiday { color: #dedede; }
    .small-text {
      font-size: .875rem; color: #dedede; margin: .25rem 0;
    }
    .medium-text {
      font-size: 1.25rem; color: #4193c9; margin: .5rem 0 .25rem;
    }
    #tapOverlay {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(42,42,42,.95); color: #dedede;
      display: flex; justify-content: center; align-items: center;
      text-align: center; font-size: 1.2rem; cursor: pointer; z-index: 9999;
      padding: 1rem;
    }
    #tapOverlay.hidden { display: none; }
  </style>
</head>
<body>
  <div id="tapOverlay">Tap to see and hear The RR Summer Countdown - Audio Recommended</div>

  <div class="countdown" id="countdownContainer">
    <div class="time-segment"><span id="weeks" class="number">0</span><span class="label">Weeks</span></div>
    <div class="time-segment"><span id="days" class="number">0</span><span class="label">Days</span></div>
    <div class="time-segment"><span id="hours" class="number">0</span><span class="label">Hours</span></div>
    <div class="time-segment"><span id="minutes" class="number">0</span><span class="label">Minutes</span></div>
    <div class="time-segment"><span id="seconds" class="number">0</span><span class="label">Seconds</span></div>
    <div class="time-segment"><span id="milliseconds" class="number">0</span><span class="label">Ms</span></div>
  </div>

  <div id="recommendedAudio"></div>

  <div class="finished-message" id="finishedMessage">
    <div class="finished-title">
      <span class="word-happy">Happy</span>
      <span class="word-summer">Summer</span>
      <span class="word-holiday">Holiday</span>
    </div>
    <p class="small-text" style="color:#5cc93b;">
      Thank you for a great RR Year! We are coming back next year! Have a happy summer holiday and enjoy it to the fullest.
    </p>
    <div class="medium-text">Special Thanks:</div>
    <p class="small-text">
      Rutham Renish (me), Ruhaan Renish, Dhruv Mondal, Benn Cern Tang, Quijun Tang, Murdoch Mackenzie,
      Jenson Cooper, Xihao 'Hani' Shen, Alex Stankov, Ali Heiba, Ronan Bingham,
      Pranav Mummalaneneni, Adhrit Nirupam and YOU ALL!
    </p>
  </div>

  <audio id="waitAudio" preload="auto" loop src="/waitmusic.mp3"></audio>
  <audio id="outroAudio" preload="auto" loop src="/outromusic.mp3"></audio>

  <script>
    const target = new Date(2025, 5, 26, 15, 0, 0, 0).getTime();
    const overlay = document.getElementById("tapOverlay");
    const cd      = document.getElementById("countdownContainer");
    const rec     = document.getElementById("recommendedAudio");
    const fin     = document.getElementById("finishedMessage");
    const waitA   = document.getElementById("waitAudio");
    const outroA  = document.getElementById("outroAudio");

    let state = 0; // 0=not started,1=wait playing,2=ready-outr,3=outro

    // mute both
    waitA.muted = outroA.muted = true;

    function init() {
      const now = Date.now();
      if (now >= target) {
        // already past zero → go to finished state
        state = 2;
        cd.style.display = "none";
        fin.style.display = "flex";
        overlay.textContent = "Tap to see our Holiday Message and Special Thanks Credits of 2025";
        overlay.classList.remove("hidden");
      } else {
        overlay.textContent = "Tap to see and hear The RR Summer Countdown - Audio Recommended";
        overlay.classList.remove("hidden");
      }
    }

    overlay.addEventListener("click", () => {
      const now = Date.now(), diff = target - now;
      if (state === 0 && now < target) {
        // start wait
        state = 1;
        overlay.classList.add("hidden");
        waitA.muted = false;
        waitA.play().catch(() => {});
        rec.textContent = "Audio Recommended – Assumptions, Sam Gellaitry";
        rec.style.display = "block";
      } else if (state === 2) {
        // start outro
        state = 3;
        overlay.classList.add("hidden");
        rec.style.display = "none";
        const offset = diff > 0
          ? (61000 - diff) / 1000
          : 61;
        outroA.muted = false;
        outroA.currentTime = offset > outroA.duration ? 0 : offset;
        outroA.play().catch(() => {});
        rec.textContent = "Audio Recommended A LOT – Xenogenisis, TheFatRat";
        rec.style.display = "block";
        if (diff <= 0) {
          cd.style.display = "none";
          fin.style.display = "flex";
        }
      }
    });

    function schedule() {
      if (state === 1) {
        const diff = target - Date.now();
        if (diff <= 60000 && diff > 0) {
          // switch to outro-ready
          state = 2;
          waitA.pause();
          waitA.currentTime = 0;
          rec.style.display = "none";
          overlay.textContent = "Tap to countdown to Summer - Audio Recommended A LOT";
          overlay.classList.remove("hidden");
        }
      }
    }

    function update() {
      const now = Date.now(), diff = target - now;

      // **NEW**: handle zero here
      if (diff <= 0) {
        clearInterval(timer);
        // hide countdown & rec
        cd.style.display = "none";
        rec.style.display = "none";
        // show finished
        fin.style.display = "flex";
        return;
      }

      // update numbers
      let d = diff;
      const w    = Math.floor(d / 604800000); d %= 604800000;
      const days = Math.floor(d / 86400000);  d %= 86400000;
      const hrs  = Math.floor(d / 3600000);   d %= 3600000;
      const mins = Math.floor(d / 60000);     d %= 60000;
      const secs = Math.floor(d / 1000), ms = d % 1000;
      document.getElementById("weeks").textContent        = w;
      document.getElementById("days").textContent         = days;
      document.getElementById("hours").textContent        = hrs;
      document.getElementById("minutes").textContent      = mins;
      document.getElementById("seconds").textContent      = secs;
      document.getElementById("milliseconds").textContent = ms;

      schedule();
    }

    init();
    const timer = setInterval(update, 1);
    update();
  </script>
</body>
</html>
